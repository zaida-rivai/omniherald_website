---
import LineBg from "@/components/LineBg.astro";
import DynamicIcon from "@/helpers/DynamicIcon";
import Base from "@/layouts/Base.astro";
import OpenPosition from "@/partials/OpenPosition.astro";
import PageHeader from "@/partials/PageHeader.astro";
import { Image } from "astro:assets";
import { getEntryBySlug } from "astro:content";
import type { Button, Funfacts, TeamMember } from "types";

interface Team {
  title: string;
  subtitle: string;
  description?: string;
  button: Button;
  members: Array<TeamMember>;
}

interface AboutProps {
  title: string;
  description: string;
  meta_title: string;
  image: string;
  funfacts: Funfacts;
  team: Team;
  goals: {
    title: string;
    subtitle: string;
  }[];
}

const entry = await getEntryBySlug("pages", "about");
const {
  title,
  description,
  meta_title,
  image,
  funfacts,
  team,
  goals,
}: AboutProps = entry.data;
---

<Base
  title={title}
  meta_title={meta_title}
  description={description}
  image={image}
>
  <main>
    <PageHeader title={title} description={description} />
    <section class="section relative z-20 mt-[-26rem] overflow-hidden">
      <div class="container relative">
        <div data-aos="fade-up-sm" data-aos-delay="150" class="row">
          <div class="md:col-6 lg:translate-x-24">
            <div
              class="max-w-[670px] rounded-[15px] border-[6px] border-white bg-white sm:border-[12px] lg:rotate-[-4deg]"
            >
              <Image
                width={608}
                height={472}
                class="w-full rounded-[15px] object-cover"
                src="/images/about-1.jpg"
                alt="gallery"
              />
            </div>
          </div>
          <div class="md:col-6 lg:-translate-x-24 lg:pt-36">
            <div
              class="relative z-10 max-w-[670px] rounded-[15px] border-[6px] border-white bg-white sm:border-[12px] lg:rotate-[8deg]"
            >
              <Image
                width={608}
                height={472}
                class="w-full rounded-[15px] object-cover"
                src="/images/about-2.jpg"
                alt="gallery"
              />
            </div>
          </div>
        </div>
        <!-- Start Shape background -->
        <div
          class="pointer-events-none absolute left-[-14%] top-[-7%] -z-10 hidden select-none md:block lg:left-0"
          data-aos="fade-right-sm"
          data-aos-delay="150"
        >
        </div>
        <div
          class="pointer-events-none absolute right-0 top-0 -z-10 hidden select-none md:block lg:right-[30%]"
          data-aos="fade-left-sm"
          data-aos-delay="150"
        >
        </div>
        <div
          class="pointer-events-none absolute bottom-[-16%] right-[35%] -z-10 hidden select-none md:block"
          data-aos="fade-down-sm"
          data-aos-delay="150"
        >
          <img
            class="inject-svg text-secondary"
            src="/images/shapes/about-s-3.svg"
            alt="shape"
          />
        </div>
        <!-- End background Lines -->
      </div>
    </section>
    <!-- End About gallery -->

    <!-- About vision -->
    <section class="section relative z-20">
      <div class="container">
        <div class="row gy-4">
          {
            goals.map((goal) => {
              return (
                <div data-aos="fade-left-sm" class="lg:col-6">
                  <span class="mb-6 inline-block font-medium uppercase text-red-400">
                    {goal.title}
                  </span>
                  <div class="border-l-2 border-dark border-opacity-50 py-2 pl-6">
                    <h2 class="font-semibold">{goal.subtitle}</h2>
                  </div>
                </div>
              );
            })
          }
        </div>
      </div>
    </section>
    <!-- End About Vision -->

    <!-- Funfacts -->
    <section class="section relative z-20 overflow-hidden">
      <div class="container">
        <div data-aos="fade-up-sm" class="row pb-12 text-center">
          <div class="mx-auto lg:col-8">
            <span
              class="mb-6 inline-block font-medium uppercase text-red-400"
              data-aos="fade-up-sm"
              data-aos-delay="50"
            >
              {funfacts.subtitle}
            </span>
            <h2
              class="mb-6 font-semibold"
              data-aos="fade-up-sm"
              data-aos-delay="100"
            >
              {funfacts.title}
            </h2>
            <p class="text-lg" data-aos="fade-up-sm" data-aos-delay="150">
              {funfacts.description}
            </p>
          </div>
        </div>
        <div class="row relative">
          <div class="col-12">
            <ul
              class="funfacts-list list-dotted-line-separator shadow-default flex flex-col justify-center gap-6 rounded-2xl bg-white px-12 py-10 sm:py-14 md:flex-row md:gap-0"
            >
              {
                funfacts.list.map((counter, index: number) => (
                  <li
                    class="text-center"
                    data-aos="fade-up-sm"
                    data-aos-delay="200"
                  >
                    <span class="mb-6 block font-secondary text-3xl font-bold text-dark md:text-4xl xl:text-6xl counter-count">
                      {counter.count}
                    </span>
                    <div class="text-dark md:text-h6 xl:text-h4">
                      {counter.text}
                    </div>
                  </li>
                ))
              }
            </ul>

            <!-- Start Bg Shape -->
            <div
              data-aos="fade-up-md"
              data-aos-delay="50"
              class="pointer-events-none absolute bottom-[-55px] left-[-30px] -z-10 hidden select-none lg:block"
            >
              <img
                class="inject-svg text-quinary"
                src="/images/shapes/fun-fact-s-1.svg"
                alt="shape"
              />
            </div>
            <div
              data-aos="fade-down-md"
              data-aos-delay="50"
              class="pointer-events-none absolute right-[-40px] top-[40px] -z-10 hidden select-none lg:block"
            >
              <img
                class="inject-svg text-secondary"
                src="/images/shapes/fun-fact-s-2.svg"
                alt="shape"
              />
            </div>
            <!-- End Bg Shape -->
          </div>
        </div>
      </div>
    </section>
    <!-- End Fun Fact Section -->

    <section
      class="section-lg has-bg-shape team-member relative z-20 overflow-hidden"
    >
      <div class="container relative z-20">
        <div class="row items-end justify-between">
          <div data-aos="fade-up-sm" class="lg:col-8 xl:col-6">
            <span
              class="mb-6 inline-block font-medium uppercase text-red-400"
              data-aos="fade-up-sm"
              data-aos-delay="50"
            >
              {team.subtitle}
            </span>
            <div
              class="mb-8 border-l-2 border-dark border-opacity-50 py-2 pl-6 lg:mb-0"
            >
              <h2
                class="font-semibold"
                data-aos="fade-up-sm"
                data-aos-delay="100"
              >
                {team.title}
              </h2>
            </div>
          </div>
          <div data-aos="fade-right-sm" data-aos-delay="150" class="col-auto">
            {
              team.button.enable && (
                <a href={team.button.link} class="btn btn-primary btn-md">
                  {team.button.label}
                </a>
              )
            }
          </div>
        </div>
        <div class="row gy-4 pt-16">
          {
            team.members.map((member) => (
              <div
                data-aos="fade-up-sm"
                data-aos-delay="50"
                class="md:col-6 lg:col-4 xl:col-3"
              >
                <div class="shadow-default overflow-hidden rounded-xl bg-white p-3 pb-0 transition-all duration-300 hover:-translate-y-1">
                  <div class="h-full max-h-[900px] w-full">
                    <Image
                      width={280}
                      height={205}
                      src={member.avatar}
                      alt="Virtual Reality for Training"
                      class="h-full w-full rounded-xl rounded-b-none object-cover"
                    />
                  </div>
                  <div class="px-5 py-8">
                    <h3 class="mb-4 text-xl font-semibold text-dark sm:text-2xl">
                      {member.name}
                    </h3>
                    <p>{member.content}</p>
                    <ul class="mt-5 flex flex-wrap items-center gap-4 font-secondary text-dark">
                      {member.socials.map((item) => {
                        return (
                          <li>
                            <a
                              href={item.link}
                              target="_blank"
                              class="inline-flex items-center justify-center h-[45px] w-[45px] rounded-full bg-quinary/10 text-center leading-[45px] transition-colors duration-300 hover:bg-dark/90 hover:text-white"
                            >
                              <DynamicIcon icon={item.icon} />
                            </a>
                          </li>
                        );
                      })}
                    </ul>
                  </div>
                </div>
              </div>
            ))
          }
        </div>

        <!-- Start Bg Shape -->
        <div
          data-aos="fade-right-sm"
          class="pointer-events-none absolute right-[-8%] top-[17%] -z-10 hidden select-none lg:block"
        >
          <img
            class="inject-svg text-quaternary"
            src="/images/shapes/team-member-s-1.svg"
            width={216}
            height={224}
            alt="shape"
          />
        </div>
        <div
          data-aos="fade-left-sm"
          class="pointer-events-none absolute bottom-[8%] left-[-6%] -z-10 hidden select-none lg:block"
        >
          <img
            class="inject-svg text-quinary"
            src="/images/shapes/team-member-s-2.svg"
            width={218}
            height={224}
            alt="shape"
          />
        </div>
        <!-- End Bg Shape -->
      </div>

      <LineBg
        color="bg-line-sky"
        className="absolute left-0 top-1/2 z-10 flex h-full w-full -translate-y-1/2 justify-between"
      />
    </section>
    <!-- End Team Member Section -->

    <OpenPosition />
  </main>
</Base>
